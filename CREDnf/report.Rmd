---
title: "NF/BCI Instructions Checklist"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: pdf_document
classoption: landscape
geometry: margin=2cm
header-includes:
- \usepackage{fancyhdr}
- \usepackage{longtable}
- \usepackage{array}
- \fancyhf{}
- \renewcommand{\headrulewidth}{0pt}
- \fancyfoot[C]{\itshape{This report has been generated using the CRED-nf online checklist version 1.0, adapted from the CRED-nf manuscript which is freely available here https://doi.org/10.1093/brain/awaa009.}}
- \fancyhead[R]{\thepage}
- \pagestyle{fancy}
- \fancypagestyle{plain}{\pagestyle{fancy}}
params:
  title: NA
  author: NA
  email: NA
  domain1: NA
  domain2: NA
  domain3: NA
  domain4: NA
  domain5: NA
  domain6: NA
  boilers: NA
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(kableExtra)
library(knitr)
library(dplyr)
escapestr <- function(x) {
  x <- gsub("\\,", "\\\\,", x)
  x <- gsub("\\.", "\\\\.", x)
  x <- gsub("\\(", "\\\\(", x)
  x <- gsub("\\)", "\\\\)", x)
  x <- gsub("\\/", "\\\\/", x)
  x <- gsub("\\?", "\\\\?", x)
  x <- gsub("\\-", "\\\\-", x)
  x <- gsub("\\:", "\\\\:", x)
  
  return(x)
}
```

```{r, echo=FALSE}
ndom <- 6

details <- vector()
for (i in 1:ndom) {
  details <- append(details, params[[paste0("domain",i)]])
}

checkIDs <- c("1a", "2a", "3a", "4a", "5a", "6a", "6b")

checkitem <- c("Instructions during the recruitment phase.",
						"Instructions at the very beginning of the NF/BCI training procedure (first session).",
						"Instructions at the beginning of each session of the NF/BCI training procedure.",
						"Instructions during the NF/BCI training sessions.",
						"Instructions at the end of the NF/BCI training procedure (end of the last session).",
						"Additional phase (e.g., transfer phase, at-home training, without NF) with different instructions.",
						"Instructions before or during this additional phase.")

table.df <- data.frame("Item.num"=checkIDs, "Checklist item"=checkitem, "Manuscript details"=details)

```


```{r}
escboil <- escapestr(details)
# Check for matches with boilerplate
boilmatch <- as.logical(sapply(escboil, function(x) {any(grepl(x, params$boilers))}))
```


**Manuscript title:** `r params$title`  
**Corresponding Author:** `r params$author`  
**Corresponding author email:** `r params$email`  
&nbsp;

**domain1:** `r params$domain1`  
**domain2:** `r params$domain2`  
**domain3:** `r params$domain3`  
**domain4:** `r params$domain4`  
**domain5:** `r params$domain5`  
**domain6:** `r params$domain6`  



\renewcommand{\arraystretch}{1.5}
```{r}
hdr <- c("Item No.", "Checklist item", "Manuscript Details")

table.df %>%
  mutate(Manuscript.details = cell_spec(Manuscript.details, italic=boilmatch)) %>%
  select(Item.num, Checklist.item, Manuscript.details) %>%
  kable(table.df, format="latex", longtable=TRUE, escape=FALSE, col.names=hdr) %>%
  kable_styling(latex_options = c("hold_position"), full_width = FALSE) %>%
  row_spec(0, bold=TRUE, font_size = 12) %>%
  column_spec(1, border_right=TRUE) %>%
  column_spec(2, border_right=TRUE, width="20em") %>%
  column_spec(3, width="40em")
# %>%
# GRRRRRRRRRRRRRRRRRRRR
#  pack_rows("Recruitment phase", hline_after = TRUE, 1) %>%
#  pack_rows("Beginning of the first NF/BCI training session", 2, hline_after = TRUE) %>%
#  pack_rows("Beginning of each NF/BCI session", 3, hline_before = TRUE) %>%
#  pack_rows("During NF/BCI sessions", 4) %>%
#  pack_rows("End of the last NF/BCI session", 5) %>%
#  pack_rows("Additional phase", 6)

```